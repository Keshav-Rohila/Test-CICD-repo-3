# # Unique name for this workflow
# name: Deploy integration branch to DEV-Branch

# # Definition when the workflow should run
# on:
#     push:
#       branches: [ DEV-Branch ]
#       paths:
#         - 'force-app/**'
            

# # Jobs to be executed
# jobs:
#     deploy-branch-to-int-and-staging-orgs:
#         runs-on: ubuntu-latest
#         if: ${{ github.actor != 'dependabot[bot]' }}
#         steps:
#             # Install Salesforce CLI
#             - name: 'Install Salesforce CLI'
#               run: |
#                   wget https://developer.salesforce.com/media/salesforce-cli/sfdx/channels/stable/sfdx-linux-x64.tar.xz
#                   mkdir ~/sfdx
#                   tar xJf sfdx-linux-x64.tar.xz -C ~/sfdx --strip-components 1
#                   echo "$HOME/sfdx/bin" >> $GITHUB_PATH
#                   ~/sfdx/bin/sfdx version

#             # install SFDX-Git-Delta plugin - https://github.com/scolladon/sfdx-git-delta
#             - name: 'Installing sfdx git delta'
#               run: | 
#                   echo y | sfdx plugins:install sfdx-git-delta
#                   sfdx plugins 

#             # Checkout the source code
#             - name: 'Checkout source code'
#               uses: actions/checkout@v3
#               with:
#                 fetch-depth: 0

#             # Store secret for both otgs
#             - name: 'Populate auth file with SFDX_URL secret of the integration and staging orgs'
#               shell: bash
#               run: |
#                   echo ${{ secrets.CICD2_SFDX_URL}} > ./CICD2_SFDX_URL.txt
                
<<<<<<< HEAD
#             - name: 'Create delta packages for new, modified or deleted metadata'
#               run: | 
#                   mkdir changed-sources
#                   sfdx sgd:source:delta --to "HEAD" --from "HEAD^" --output changed-sources/ --generate-delta --source force-app/
=======
            - name: 'Create delta packages for new, modified or deleted metadata'
              run: | 
                  mkdir changed-sources2
                  sfdx sgd:source:delta --to "HEAD" --from "HEAD^" --output changed-sources2/ --generate-delta --source force-app/
>>>>>>> 8b9ebb25db5f774e4110e8fafbad1ca45f4209d2

#             # Authenticate to org
#             - name: 'Authenticate to Integration Org'
#               run: sfdx auth:sfdxurl:store -f ./CICD2_SFDX_URL.txt -a QA -d

#             - name: 'Deploy the entire branch to Integration org'
#               run: sfdx force:source:deploy -p force-app --testlevel RunLocalTests --json -u cicdtest2@apt.com.dev

            

            
